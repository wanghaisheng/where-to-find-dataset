---
author: wanghaisheng
cover:
  alt: cover
  square: https://www.apple.com.cn/newsroom/images/product/homepod/standard/Apple-HomePod-hero-230118_big.jpg.large_2x.jpg
  url: https://www.apple.com.cn/newsroom/images/product/homepod/standard/Apple-HomePod-hero-230118_big.jpg.large_2x.jpg
description: ''
featured: true
keywords: key1, key2, key3
layout: ../../layouts/MarkdownPost.astro
meta:
- content: Motunrayo Ibiyo et.al.
  name: author
- content: key3, key4
  name: keywords
pubDate: '2025-04-21 11:42:59'
tags:
- all search terms
- dataset
theme: light
title: Detecting Malicious Source Code in PyPI Packages with LLMs Does RAG Come in
  Handy
---

# title: Detecting Malicious Source Code in PyPI Packages with LLMs Does RAG Come in Handy 
## publish date: 
**2025-04-18** 
## authors: 
  Motunrayo Ibiyo et.al. 
## paper id
2504.13769v1
## download
[2504.13769v1](http://arxiv.org/abs/2504.13769v1)
## abstracts:
Malicious software packages in open-source ecosystems, such as PyPI, pose growing security risks. Unlike traditional vulnerabilities, these packages are intentionally designed to deceive users, making detection challenging due to evolving attack methods and the lack of structured datasets. In this work, we empirically evaluate the effectiveness of Large Language Models (LLMs), Retrieval-Augmented Generation (RAG), and few-shot learning for detecting malicious source code. We fine-tune LLMs on curated datasets and integrate YARA rules, GitHub Security Advisories, and malicious code snippets with the aim of enhancing classification accuracy. We came across a counterintuitive outcome: While RAG is expected to boost up the prediction performance, it fails in the performed evaluation, obtaining a mediocre accuracy. In contrast, few-shot learning is more effective as it significantly improves the detection of malicious code, achieving 97% accuracy and 95% balanced accuracy, outperforming traditional RAG approaches. Thus, future work should expand structured knowledge bases, refine retrieval models, and explore hybrid AI-driven cybersecurity solutions.
## QA:
coming soon
